-- This script was used to create a subset of the original EMR metadata tables (after they had been staged into the
-- local data warehouse). This is just for informal purposes - there is no need to run these scripts if you want to
-- replicate our approach.
-- The "PD_" suffix indicates "PLOS DEMO".

CREATE TABLE PD_DWH_METADATEN_ONTOLOGY_SEB AS (
SELECT DISTINCT FORMID, FORM_ADMINNAME, USAGENAME, FORM_DISPLAYNAME, FORMVERSION, STAGED, COMPONENTID, COMP_ADMINNAME, COMP_DISPLAYNAME, COMPONENTVERSION, EDITOR, CARRYFORWARD, OPTIONS_INT, OPTIONS_EXP, TABORDER
FROM DWH_METADATEN_ONTOLOGY_SEB
WHERE FORMID IN (23955, 23953, 23949, 14714, 14712, 14070)
  AND COMPONENTID IN (23947, 23946, 14400, 14399, 14398, 14397, 14372, 14371, 14370, 14369, 13928, 13927, 13926, 13447)
);

CREATE TABLE PD_DWH_METADATEN_FELDER AS (
SELECT DISTINCT FORMID, COMPONENTID, COM_LAST_FORMVERSION, LAST_COMVERSION, ADMINNAME, DISPLAYNAME, OPTIONS, OPT_LAST_FORMVERSION, TABORDER, EDITOR, EXPORTED_DATA
FROM DWH_METADATEN_FELDER
WHERE FORMID IN (23955, 23953, 23949, 14714, 14712, 14070)
  AND COMPONENTID IN (23947, 23946, 14400, 14399, 14398, 14397, 14372, 14371, 14370, 14369, 13928, 13927, 13926, 13447)
);

CREATE TABLE PD_DWH_NUTZDATEN_FORMCHAPTERS AS (
SELECT DISTINCT MAIN_FORMID, MAIN_FORMVERSION, SUB_FORMID, SUB_FORMVERSION
FROM DWH_NUTZDATEN_FORMCHAPTERS
WHERE MAIN_FORMID IN (23955, 23953, 23949, 14714, 14712, 14070)
  AND SUB_FORMID IN (23955, 23953, 23949, 14714, 14712, 14070)
);

CREATE TABLE PD_DWH_METADATEN_FORMULARE AS (
SELECT DISTINCT FORM_GROUP, FORMID, ADMINNAME, DISPLAYNAME, LASTMODIFIED
FROM DWH_METADATEN_FORMULARE
WHERE FORMID IN (23955, 23953, 23949, 14714, 14712, 14070)
);